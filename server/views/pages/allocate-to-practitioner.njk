{% extends "partials/layout.njk" %}
{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}
{% from "../components/pop/macro.njk" import pop %}


{% set offenderManagerDetails = data.forename + ' ' + data.surname + (' (' + data.grade + ')' if data.grade)  %}

{% block beforeContent %}
    {{ govukBreadcrumbs({
        items: [
            {
                text: "Home"
            },
            {
                text: "Unallocated cases",
                href: "/team/" + teamCode + "/cases/unallocated"
            },
            {
                text: "Case details",
                href: "/team/" + teamCode + "/" + crn + "/convictions/" + convictionNumber + "/case-view"
            },
            {
               text: "Allocate to probation practitioner",
                href: "/team/" + teamCode + "/" + crn + "/convictions/" + convictionNumber + "/choose-practitioner"
            }
        ]
    }) }}
{% endblock %}

{% block content %}

    {{ pop({name: name, crn: crn, tier: tier}) }}

    <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    <h2 class="govuk-heading-l">You're allocating this case to probation practitioner {{ offenderManagerDetails }}</h2>
    {% if data.capacity == data.potentialCapacity %}
        <p id="impact-statement">Their workload will remain at <span class="{{ 'percentage-extra-over' if data.capacity > 100 }}">{{ data.capacity | round(1)}}%</span> as they are already managing this case.</p>
    {% else %}
        <p id="impact-statement">This will increase their workload from <span class="{{ 'percentage-extra-over' if data.capacity > 100 }}">{{ data.capacity | round(1)}}%</span> to <span class="{{ 'percentage-extra-over' if data.potentialCapacity > 100 }}">{{ data.potentialCapacity | round(1) }}%</span>.</p>
    {% endif %}
    <div class="govuk-form-group govuk-!-margin-top-9">
        <div class="govuk-button-group">
          <a class="govuk-button" href="{{ '/team/' + teamCode + '/' + crn + '/convictions/' + convictionNumber + '/allocate/' + staffTeamCode +  '/' + staffCode +  '/instructions' }}">Continue</a>
          <a class="govuk-link govuk-link--no-visited-state" href="{{ '/team/' + teamCode + '/' + crn + '/convictions/' + convictionNumber + '/choose-practitioner' }}">Choose a different probation practitioner</a>
        </div>
      </div>
{% endblock %}

