{% extends "../partials/layout.njk" %}
{%- from "moj/components/sub-navigation/macro.njk" import mojSubNavigation -%}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

{% set cases = unallocatedCases | length  %}
{% set pageTitle = applicationName + " - Home" %}
{% set tableData = {
    caption: 'Unallocated community cases',
    captionClasses: 'govuk-heading-l',
    head: [
        { text: 'Name / CRN' },
        { text: 'Tier' },
        { text: 'Sentence date' },
        { text: 'Induction appointment' },
        { text: 'Probation status' },
        { text: 'Action' }
    ],
    rows: []
} %}

{% for item in unallocatedCases %}
    {%- set tableRow = [
        { text: item.name },
        { text: item.tier },
        { text: item.sentenceDate | dateFormat },
        { text: item.initialAppointment | dateFormat if item.initialAppointment else 'Not booked' },
        { text: item.status },
        { text: ('<a href="/" class="govuk-!-font-weight-bold govuk-link govuk-link--no-visited-state" aria-label="Review case">' + "Review case" + '</a>' ) | safe}
    ] -%}
    {{ tableData.rows.push(tableRow) }}

{% endfor %}

{% block content %}

        <span class="govuk-caption-xl">Gateshead and South Tyneside</span>
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">South Tyneside</h1>

        {{ mojSubNavigation({
          label: 'Sub navigation',
          items: [{
            text: unallocatedCaseSubnavHeading,
            href: '#',
            active: true
          }]
        }) }}


        {{ govukTable(tableData) }}

    {% if not unallocatedCases | length %}
          <p class="govuk-!-margin-bottom-9">No case list information available.</p>
    {% endif %}

            <h2 class="govuk-heading-l">Other unallocated cases</h2>
            {{ govukInsetText({
                text: "There may currently be unallocated custody cases on NDelius."
            }) }}


{% endblock %}
