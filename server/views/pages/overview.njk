{% extends "partials/officer-view.njk" %}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "../components/card/macro.njk" import card %}

{% set pageTitle = applicationName + " - Overview" %}

{% block officerContent %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">

            <h2 class="govuk-heading-l govuk-!-margin-bottom-0">Current workload</h2>
            <p class="govuk-body-s govuk-!-margin-bottom-2">Last updated: {{ data.lastUpdatedOn | dateFormat }} at {{ data.lastUpdatedOn | timeFormat }}</p>

            <div class="govuk-grid-row">
                <div class="card__layout">
                    {{ card({
                        classes: 'card-total',
                        titleHtml: ('<a href="/' + crn + '/convictions/' + convictionId + '/allocate/' + data.offenderManagerCode + '/active-cases" class="govuk-link--no-visited-state" aria-label="Total cases">' + data.offenderManagerTotalCases + '<br>' + '<p>' + "total cases"  + '</p>' + '</a>')
                    }) }}
                </div>
                <div class="card__layout">
                    {{ card({
                        classes: 'card-total-subset ' + ('over-capacity' if data.offenderManagerCurrentCapacity > 99 else 'under-capacity'),
                        titleHtml: (data.offenderManagerCurrentCapacity + '%' + '<p class="">' + "capacity"  + '</p>')
                    }) }}
                </div>

            </div>


            {{ govukDetails({
                summaryText: "View as points",
                text: govukSummaryList({
                    rows: [
                        {
                            key: {
                            text: "Points available"
                        },
                            value: {
                            text: data.offenderManagerPointsAvailable
                        }
                        },
                        {
                            key: {
                            text: "Points used"
                        },
                            value: {
                            text: data.offenderManagerPointsUsed
                        }
                        },
                        {
                            key: {
                            text: "Points remaining"
                        },
                            value: {
                            text: data.offenderManagerPointsRemaining
                        }
                        }
                    ]
                })
            }) }}

            <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

            <h2 class="govuk-heading-l">Availability</h2>

        </div>

        <div class="govuk-grid-column-one-third">
        </div>
    </div>
{% endblock %}
