{% extends "../partials/layout.njk" %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/accordion/macro.njk" import govukAccordion %}

{%set technicalUpdateItems = []%}

{% for technicalUpdate in technicalUpdates%}
    {% set content %}
        <h2 class="govuk-heading-s">What's new</h2>
        <ul class="govuk-list govuk-list--bullet">
            {% for whatsNew in technicalUpdate.whatsNew %}
                <li>{{ whatsNew }}</li>
            {% endfor%}
         </ul>
        <h2 class="govuk-heading-s">Technical fixes</h2>
        <ul class="govuk-list govuk-list--bullet"> 
            {% for technicalFix in technicalUpdate.technicalFixes %}
                <li>{{ technicalFix }}</li>
            {% endfor%}
        </ul>
    {% endset %}
    {% set technicalUpdateItems = (technicalUpdateItems.push({
         heading: { 
            text: technicalUpdate.heading 
         }, 
         content:{ 
            html: content 
            }
        }), technicalUpdateItems) %}
{% endfor %}

{% block beforeContent %}
    {% if referrer %}
        {{ govukBackLink({
            text: "Back",
            href: referrer
        }) 
        }}
    {% endif %}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        <span class="govuk-caption-xl">Allocations</span>
        <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">Technical updates</h1>
    </div>    
</div>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <p data-qa-link="send-feedback">Send us feedback <a class="govuk-link--no-visited-state" href="mailto:manageaworkforce@justice.gov.uk">by email</a>.</p>

        {{ govukAccordion({
            id: "accordion-default",
            items: technicalUpdateItems
           }) 
        }}

    </div>
</div>

{% endblock %}

{% block javascripts %}
     <script nonce="{{ cspNonce }}">
        localStorage.setItem("technicalUpdateReadVersion", "{{ lastTechnicalUpdate }}")
     </script>
{% endblock %}